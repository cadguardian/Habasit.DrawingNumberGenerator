
Create me a text extractor service for my blazor web assembly app using dependency injection.

The service will extract data from the email according to this data model:

using System.ComponentModel.DataAnnotations;

namespace DNG.Library.Data;

public class DrawingRequest
{
    // Properties in order of user input
    [Key]
    public Guid Id { get; set; } = Guid.NewGuid();

    public string BeltType { get; set; } = string.Empty;

    public string BeltSeries { get; set; } = string.Empty;

    public string Color { get; set; } = string.Empty;

    public string Material { get; set; } = string.Empty;

    public string AdderMaterial { get; set; } = string.Empty;

    public string RodMaterial { get; set; } = string.Empty; // Email may just say RODS:

    public decimal BeltWidth { get; set; }

    public int QtyRollersAcrossWidth { get; set; }

    public decimal FRGCenters { get; set; }

    public string FlightsRollersGrip { get; set; } = string.Empty;
    public string BeltAccessories { get; set; } = string.Empty;
    public string FrictionAntiStatic { get; set; } = string.Empty;
    public string SidePLLaneDV { get; set; } = string.Empty;

    public string UniqueIdentification { get; set; } = string.Empty;

    public string IndentCode { get; set; } = string.Empty;

    // CRM Data
    public string SugarCRMSubjectLine { get; set; }

    public DateTime StartDate { get; set; }
    public string AssignedTo { get; set; }
    public string FW { get; set; } //
}

You will recognize the values will be structured in the following pattern due to being generated by a epicor configurator. so you will need to intelligently assign values to there designated field and You will need to catch all info after the pattern for special case info as a catch all. Perhaps a <string,string> Dictionary field named intelligently.You also need to think logically about what may be fields with empty values according to the logic.

BELT: SERIES MATERIAL COLOR
RODS: RODMATERIAL
BELT WIDTH: BELTWIDTHINCHES +/- TOLERANCE LINKCOUNT
BELT LENGTH: LENGTHINFT (LENGTHINSQUAREFEET)
FLIGHT: FLIGHTYPE FLIGHTMATERIAL FLIGHTMATERIAL
SPACING: FRGSPACINGININCHES
INDENT: INDENTININCHES

The information below is most likely special case info like
SANICLIP: Qty: 1 SPACING: 0
ATTACHMENTS
COMMENTLOGS
OTHER OVERFLOW DETAILS FOR DICTIONARY

NOW That you have been told about the patterns I will now give you training data of 5 emails. I copied these emails directly from SugarCRM hoping that the updated data model and function you provide will consistently extract details from these drawing request email as a string and return a drawingrequest json. Also provide a load data function that i can use for quick testing and aligning:

Here is EMAIL 1:

2271343 MB

Cancel Save
Start Date
10-10-2024 01:26 PM
Due Date
Priority
Medium
Status
Not Started
Assigned to
Smith, Thomas
Case
Fw: PO# 40804743
Class
Application Engineering / Technical Services
Type
Description
BELT: M2510 Flat Top Polypropylene White
RODS: Polypropylene
BELT WIDTH: 6.6 IN +/- 0.10 (10) Links
BELT LENGTH: 30.00 FT (16.5 Square FT)
FLIGHT: 2.000 IN High Streamline Polypropylene White
SPACING: 6.00 IN
INDENT: 1.30 IN
SANICLIP: Qty: 1 SPACING: 0
Attachments
Comment Log
Hamad, Biro 10-10-2024 01:26 PM
Good afternoon,

Please provide a drawing per customer request
Powers, Steve 10-10-2024 04:13 PM
Indent is made with modules not machined

Here is EMAIL 2:

2271313

Cancel Save
Start Date
10-10-2024 12:10 PM
Due Date
Priority
Medium
Status
Completed
Assigned to
Powers, Steve
Case
FW: Habasit America, Inc. - Quote# 1959541/ PO # 87507
Class
Application Engineering / Technical Services
Type
Description
Please make a drawing based off this one

BELT: M2520 Flat Top Polypropylene Gray
RODS: Polypropylene
BELT WIDTH: 5.9 IN +/- 0.10 (9) Links
BELT LENGTH: 12.00 FT (5.9 Square FT)
FLIGHT: 2.000 IN High Streamline Polypropylene Gray
SPACING: 4.00 IN
INDENT: Machined 0.25 IN
Attachments
MH0106411.pdf
Comment Log
Powers, Steve 10-14-2024 08:47 AM
Williams, Adora  M2520GP-P00590200040XXXX5

Here is EMAIL 3:

MODULAR SPECIAL BUILD DRAWING NEEDED

Edit 
Start Date
10-11-2024 02:52 PM
Due Date
10-14-2024 02:53 PM
Priority
Medium
Status
Not Started
Assigned to
Smith, Thomas
Account
DELTA SYSTEMS & AUTOMATION LLC -
Class
Application Engineering / Technical Services
Type
Description
I need a drawing for the following please. SO# 2271376 See attached customer drawing.

BELT: M1220 Flat Top Polyethylene Natural
RODS: Polyethylene
BELT WIDTH: 3.9 IN +/- 0.10 (6) Links
BELT LENGTH: 16.00 FT (5.2 Square FT)
FLIGHT: 1.75 IN. High CUT Streamline Polyethylene Natural
SPACING: 6.00 IN
INDENT: Machined 1.59 IN
*** SPECIAL BUILD : TBD ***

GENERAL COMMENTS:
There needs to be a .75in wide flight centered on the belt.
Attachments
3146700444.pdf

Here is EMAIL 4:

QT 1960599 / painted lines

Edit 
Start Date
10-14-2024 09:52 AM
Due Date
10-14-2024 09:52 AM
Priority
Medium
Status
Not Started
Assigned to
US_Fabric_Drawings
Related To
Class
Application Engineering / Technical Services
Type
Description
Attachments
Comment Log
Judy, Todd 10-14-2024 09:54 AM
Please create drawing for painted lines- details are stated below.                                                                                                                                                                                                           BELT: RGLIDE-T
WIDTH: 16.000 Inches
LENGTH: 72.000 Feet 0 Inches
MEASUREMENT REFERENCE: NEL

FINISH: LACE (Metal Lace)  / Customer Specific / #1HT Clipper Recommended pin

GENERAL COMMENTS: Apply 6" wide white pace lines perpendicular to belt edge on 46" centers.